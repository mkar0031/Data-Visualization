{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width":"container",
  "height": 300,
  "data": {
    "url": "data/oil-production-by-country.csv"
  },
  "transform": [
    {
      "window": [{
        "op": "rank",
        "as": "rank"
      }],
      "sort": [{ "field": "Production", "order": "descending" }]
    }, {
      "filter": "datum.rank <= 5"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {"field": "Year", "type": "temporal", "title": "Year"},
    "y": {"field": "Production", "type": "nominal", "title": "Production", "aggregate":"sum", "sort": {"op": "sum", "order":"ascending"}},
    "color": {"field": "Entity", "type": "nominal", "title": "Country"},
    "tooltip": [
      {"field": "Entity", "type": "nominal", "title":"Country"},
      {"field": "Production", "format": ".2f", "title": "Production"},
      {"field": "Year","type": "temporal", "title": "Date"}
    ]
  }
}
